{"componentChunkName":"component---src-templates-blog-post-js","path":"/database-info-encode-and-decode/","result":{"data":{"site":{"siteMetadata":{"title":"Funny Eagle","author":"Jason Yang"}},"markdownRemark":{"id":"986e0a78-d9da-538e-b950-300f648075b9","excerpt":"我们一般都会把数据库的连接信息写在properties配置文件里，只要打开了配置文件，就能直接看到数据库的用户名密码等信息，一些项目会要求不能出现明文密码，接下来，简单三步，实现配置文件里的用户名和…","html":"<blockquote>\n<p>我们一般都会把数据库的连接信息写在properties配置文件里，只要打开了配置文件，就能直接看到数据库的用户名密码等信息，一些项目会要求不能出现明文密码，接下来，简单三步，实现配置文件里的用户名和密码加密。</p>\n</blockquote>\n<h3 id=\"一加密解密工具类\" style=\"position:relative;\"><a href=\"#%E4%B8%80%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E5%B7%A5%E5%85%B7%E7%B1%BB\" aria-label=\"一加密解密工具类 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>一、加密解密工具类</h3>\n<p>我以Base64为例，写个简单的加密和解密工具</p>\n<pre><code class=\"language-java\">package org.nocoder.utils;\n\nimport org.apache.commons.codec.binary.Base64;\nimport org.apache.commons.lang3.StringUtils;\n\n/**\n * EncryptUtil\n * Created by jason on 2017/7/18.\n */\npublic class EncryptUtil {\n\n    /**\n     * 加密\n     * @param value\n     * @return encode string value\n     */\n    public static String encode(String value){\n        if(StringUtils.isNotBlank(value)){\n            Base64 base64 = new Base64();\n            return new String(base64.encode(value.getBytes()));\n        }\n        return null;\n    }\n\n    /**\n     * 解密\n     * @param value\n     * @return decode string value\n     */\n    public static String decode(String value){\n        if(StringUtils.isNotBlank(value)){\n            Base64 base64 = new Base64();\n            return new String(base64.decode(value.getBytes()));\n        }\n        return null;\n    }\n\n    public static void main(String[] args) {\n        System.out.println(EncryptUtil.encode(\"test\"));\n        System.out.println(EncryptUtil.decode(\"dGVzdA==\"));\n    }\n}\n\n</code></pre>\n<h3 id=\"二通过继承spring配置类并重写处理方法实现解密\" style=\"position:relative;\"><a href=\"#%E4%BA%8C%E9%80%9A%E8%BF%87%E7%BB%A7%E6%89%BFspring%E9%85%8D%E7%BD%AE%E7%B1%BB%E5%B9%B6%E9%87%8D%E5%86%99%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0%E8%A7%A3%E5%AF%86\" aria-label=\"二通过继承spring配置类并重写处理方法实现解密 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>二、通过继承spring配置类并重写处理方法实现解密</h3>\n<pre><code class=\"language-java\">package org.nocoder.security;\n\nimport org.apache.commons.lang3.StringUtils;\nimport org.nocoder.utils.EncryptUtil;\nimport org.springframework.beans.BeansException;\nimport org.springframework.beans.factory.BeanInitializationException;\nimport org.springframework.beans.factory.config.ConfigurableListableBeanFactory;\nimport org.springframework.beans.factory.config.PropertyPlaceholderConfigurer;\n\nimport java.util.Properties;\n\n/**\n * 通过继承spring配置类并重写处理方法实现密文解密\n * Created by jason on 2017/7/18.\n */\npublic class EncryptPropertyPlaceholderConfigurer extends PropertyPlaceholderConfigurer{\n    @Override\n    protected void processProperties(ConfigurableListableBeanFactory beanFactory, Properties props) throws BeansException {\n        try {\n            String username = props.getProperty(\"username\");\n            if(StringUtils.isNotBlank(username)){\n                props.setProperty(\"username\", EncryptUtil.decode(username));\n            }\n\n            String password = props.getProperty(\"password\");\n            if(StringUtils.isNotBlank(password)){\n                props.setProperty(\"password\",EncryptUtil.decode(password));\n            }\n            super.processProperties(beanFactory, props);\n        } catch (Exception e) {\n            e.printStackTrace();\n            throw new BeanInitializationException(e.getMessage());\n        }\n    }\n}\n\n</code></pre>\n<h3 id=\"三修改配置文件\" style=\"position:relative;\"><a href=\"#%E4%B8%89%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\" aria-label=\"三修改配置文件 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>三、修改配置文件</h3>\n<p>1、使用加密工具类对用户名和密码进行加密，修改properties配置文件<code>config.properties</code></p>\n<pre><code class=\"language-java\">driver=org.postgresql.Driver\nurl=jdbc:postgresql://127.0.0.1:5432/freda_db\nusername=加密后的用户名\npassword=加密后的密码\n#定义初始连接数\ninitialSize=0\n#定义最大连接数\nmaxActive=50\n#定义最大空闲\nmaxIdle=50\n#定义最小空闲\nminIdle=1\n#定义最长等待时间\nmaxWait=60000\n</code></pre>\n<p>2、修改<code>applicationContext.xml</code>，引入配置文件</p>\n<pre><code class=\"language-java\">&#x3C;!-- 引入配置文件，这里的class就是之前写的那个Spring配置类的路径 -->\n&#x3C;bean id=\"encryptPropertyConfigurer\" class=\"org.nocoder.security.EncryptPropertyPlaceholderConfigurer\">\n    &#x3C;property name=\"locations\">\n        &#x3C;list>\n            &#x3C;value>classpath:config.properties&#x3C;/value>\n        &#x3C;/list>\n    &#x3C;/property>\n&#x3C;/bean>\n</code></pre>\n<p>OK了，就这三步，重启服务试试看！</p>","tableOfContents":"<ul>\n<li><a href=\"#%E4%B8%80%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E5%B7%A5%E5%85%B7%E7%B1%BB\">一、加密解密工具类</a></li>\n<li><a href=\"#%E4%BA%8C%E9%80%9A%E8%BF%87%E7%BB%A7%E6%89%BFspring%E9%85%8D%E7%BD%AE%E7%B1%BB%E5%B9%B6%E9%87%8D%E5%86%99%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0%E8%A7%A3%E5%AF%86\">二、通过继承spring配置类并重写处理方法实现解密</a></li>\n<li><a href=\"#%E4%B8%89%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\">三、修改配置文件</a></li>\n</ul>","frontmatter":{"title":"Spring 数据库密码加密","tags":["coding"],"description":"一些项目会要求不能出现明文密码，简单三步，实现配置文件里的用户名和密码加密。","date":"2017-07-18"}}},"pageContext":{"slug":"/database-info-encode-and-decode/","previous":{"fields":{"slug":"/apache-commons-codec/"},"frontmatter":{"title":"Apache Commons Codec 加密解密","tags":["coding"],"slug":""}},"next":{"fields":{"slug":"/idea-for-mac-key-map/"},"frontmatter":{"title":"【转载】IntelliJ IDEA For Mac 快捷键","tags":["coding"],"slug":""}}}},"staticQueryHashes":["2052298874"],"slicesMap":{}}