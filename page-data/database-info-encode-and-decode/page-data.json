{"componentChunkName":"component---src-templates-blog-post-js","path":"/database-info-encode-and-decode/","result":{"data":{"site":{"siteMetadata":{"title":"Jason Yang's Blog"}},"markdownRemark":{"id":"df03a941-4979-5dfe-8ece-2197ca305d41","excerpt":"我们一般都会把数据库的连接信息写在properties配置文件里，只要打开了配置文件，就能直接看到数据库的用户名密码等信息，一些项目会要求不能出现明文密码，接下来，简单三步，实现配置文件里的用户名和密码加密。 一、加密解密工具类 我以Base64为例，写个简单的加密和解密工具 二、通过继承spring…","html":"<blockquote>\n<p>我们一般都会把数据库的连接信息写在properties配置文件里，只要打开了配置文件，就能直接看到数据库的用户名密码等信息，一些项目会要求不能出现明文密码，接下来，简单三步，实现配置文件里的用户名和密码加密。</p>\n</blockquote>\n<h3>一、加密解密工具类</h3>\n<p>我以Base64为例，写个简单的加密和解密工具</p>\n<deckgo-highlight-code language=\"java\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">package org.nocoder.utils;\n\nimport org.apache.commons.codec.binary.Base64;\nimport org.apache.commons.lang3.StringUtils;\n\n/**\n * EncryptUtil\n * Created by jason on 2017/7/18.\n */\npublic class EncryptUtil {\n\n    /**\n     * 加密\n     * @param value\n     * @return encode string value\n     */\n    public static String encode(String value){\n        if(StringUtils.isNotBlank(value)){\n            Base64 base64 = new Base64();\n            return new String(base64.encode(value.getBytes()));\n        }\n        return null;\n    }\n\n    /**\n     * 解密\n     * @param value\n     * @return decode string value\n     */\n    public static String decode(String value){\n        if(StringUtils.isNotBlank(value)){\n            Base64 base64 = new Base64();\n            return new String(base64.decode(value.getBytes()));\n        }\n        return null;\n    }\n\n    public static void main(String[] args) {\n        System.out.println(EncryptUtil.encode(&quot;test&quot;));\n        System.out.println(EncryptUtil.decode(&quot;dGVzdA==&quot;));\n    }\n}\n</code>\n        </deckgo-highlight-code>\n<h3>二、通过继承spring配置类并重写处理方法实现解密</h3>\n<deckgo-highlight-code language=\"java\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">package org.nocoder.security;\n\nimport org.apache.commons.lang3.StringUtils;\nimport org.nocoder.utils.EncryptUtil;\nimport org.springframework.beans.BeansException;\nimport org.springframework.beans.factory.BeanInitializationException;\nimport org.springframework.beans.factory.config.ConfigurableListableBeanFactory;\nimport org.springframework.beans.factory.config.PropertyPlaceholderConfigurer;\n\nimport java.util.Properties;\n\n/**\n * 通过继承spring配置类并重写处理方法实现密文解密\n * Created by jason on 2017/7/18.\n */\npublic class EncryptPropertyPlaceholderConfigurer extends PropertyPlaceholderConfigurer{\n    @Override\n    protected void processProperties(ConfigurableListableBeanFactory beanFactory, Properties props) throws BeansException {\n        try {\n            String username = props.getProperty(&quot;username&quot;);\n            if(StringUtils.isNotBlank(username)){\n                props.setProperty(&quot;username&quot;, EncryptUtil.decode(username));\n            }\n\n            String password = props.getProperty(&quot;password&quot;);\n            if(StringUtils.isNotBlank(password)){\n                props.setProperty(&quot;password&quot;,EncryptUtil.decode(password));\n            }\n            super.processProperties(beanFactory, props);\n        } catch (Exception e) {\n            e.printStackTrace();\n            throw new BeanInitializationException(e.getMessage());\n        }\n    }\n}\n</code>\n        </deckgo-highlight-code>\n<h3>三、修改配置文件</h3>\n<p>1、使用加密工具类对用户名和密码进行加密，修改properties配置文件<code>config.properties</code></p>\n<deckgo-highlight-code language=\"java\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">driver=org.postgresql.Driver\nurl=jdbc:postgresql://127.0.0.1:5432/freda_db\nusername=加密后的用户名\npassword=加密后的密码\n#定义初始连接数\ninitialSize=0\n#定义最大连接数\nmaxActive=50\n#定义最大空闲\nmaxIdle=50\n#定义最小空闲\nminIdle=1\n#定义最长等待时间\nmaxWait=60000</code>\n        </deckgo-highlight-code>\n<p>2、修改<code>applicationContext.xml</code>，引入配置文件</p>\n<deckgo-highlight-code language=\"java\" terminal=\"carbon\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">&lt;!-- 引入配置文件，这里的class就是之前写的那个Spring配置类的路径 --&gt;\n&lt;bean id=&quot;encryptPropertyConfigurer&quot; class=&quot;org.nocoder.security.EncryptPropertyPlaceholderConfigurer&quot;&gt;\n    &lt;property name=&quot;locations&quot;&gt;\n        &lt;list&gt;\n            &lt;value&gt;classpath:config.properties&lt;/value&gt;\n        &lt;/list&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;</code>\n        </deckgo-highlight-code>\n<p>OK了，就这三步，重启服务试试看！</p>","frontmatter":{"title":"Spring 数据库密码加密","date":"2017年07月18日 12:03:42","description":"一些项目会要求不能出现明文密码，简单三步，实现配置文件里的用户名和密码加密。"}},"previous":{"fields":{"slug":"/apache-commons-codec/"},"frontmatter":{"title":"Apache Commons Codec 加密解密"}},"next":{"fields":{"slug":"/idea-for-mac-key-map/"},"frontmatter":{"title":"【转载】IntelliJ IDEA For Mac 快捷键"}}},"pageContext":{"id":"df03a941-4979-5dfe-8ece-2197ca305d41","previousPostId":"a5a4e4a0-75d3-5365-80aa-33a9f488e922","nextPostId":"3c89b2b2-1967-54fa-abe6-91af3c25a620"}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}