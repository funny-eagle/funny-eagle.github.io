{"componentChunkName":"component---src-templates-blog-post-js","path":"/free-ssl-certs/","result":{"data":{"site":{"siteMetadata":{"title":"Nocoder.Org"}},"markdownRemark":{"id":"6f070c82-26a4-5229-a32c-a7c4070f9ace","excerpt":"Let's Encrypt是一个非营利性组织，旨在使HTTPS成为互联网的标准，他们提供免费HTTPS证书，以便更多的网站可以使用HTTPS加密保护用户的隐私和安全。 我们可以通过Certbot申请免费HTTPS证书，步骤如下： 安装Certbot：Certbot是Let's Encrypt…","html":"<p>Let's Encrypt是一个非营利性组织，旨在使HTTPS成为互联网的标准，他们提供免费HTTPS证书，以便更多的网站可以使用HTTPS加密保护用户的隐私和安全。</p>\n<p>我们可以通过Certbot申请免费HTTPS证书，步骤如下：</p>\n<ol>\n<li>安装Certbot：Certbot是Let's Encrypt的官方客户端，可自动化证书颁发和安装过程</li>\n<li>运行Certbot：运行Certbot以启动证书颁发和安装过程。</li>\n<li>等待证书颁发：Certbot将与Let's Encrypt服务器通信以颁发证书，需要几秒钟或几分钟。</li>\n<li>安装证书：Certbot将自动安装证书并配置您的Web服务器以使用HTTPS。</li>\n</ol>\n<p>注意，需要在每90天内更新证书。Certbot可以自动化此过程，因此无需手动更新证书。</p>\n<p>以下是具体命令，以<code class=\"language-text\">Ubuntu</code>、<code class=\"language-text\">Nginx</code>为例：</p>\n<ol>\n<li>安装Certbot</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo apt install certbot</code></pre></div>\n<ol start=\"2\">\n<li>安装Certbot Nginx插件，</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo apt install python3-certbot-nginx</code></pre></div>\n<blockquote>\n<p>如果用Apache，就安装Apache插件 `sudo apt install python3-certbot-apache</p>\n</blockquote>\n<ol start=\"3\">\n<li>使用certbot nginx 插件为域名申请证书</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo certbot --nginx -d nocoder.org -d www.nocoder.org</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">sudo</span> certbot <span class=\"token parameter variable\">--nginx</span> <span class=\"token parameter variable\">-d</span> nocoder.org <span class=\"token parameter variable\">-d</span> www.nocoder.org\r\nSaving debug log to /var/log/letsencrypt/letsencrypt.log\r\nPlugins selected: Authenticator nginx, Installer nginx\r\nEnter email address <span class=\"token punctuation\">(</span>used <span class=\"token keyword\">for</span> urgent renewal and security notices<span class=\"token punctuation\">)</span>\r\n <span class=\"token punctuation\">(</span>Enter <span class=\"token string\">'c'</span> to cancel<span class=\"token punctuation\">)</span>: yangjinlong86@gmail.com\r\n\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\nPlease <span class=\"token builtin class-name\">read</span> the Terms of Service at\r\nhttps://letsencrypt.org/documents/LE-SA-v1.3-September-21-2022.pdf. You must\r\nagree <span class=\"token keyword\">in</span> order to register with the ACME server. Do you agree?\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n<span class=\"token punctuation\">(</span>Y<span class=\"token punctuation\">)</span>es/<span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span>o: Y\r\n\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\nWould you be willing, once your first certificate is successfully issued, to\r\nshare your email address with the Electronic Frontier Foundation, a founding\r\npartner of the Let<span class=\"token string\">'s Encrypt project and the non-profit organization that\r\ndevelops Certbot? We'</span>d like to send you email about our work encrypting the web,\r\nEFF news, campaigns, and ways to support digital freedom.\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n<span class=\"token punctuation\">(</span>Y<span class=\"token punctuation\">)</span>es/<span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span>o: Y\r\nAccount registered.\r\nRequesting a certificate <span class=\"token keyword\">for</span> nocoder.org and www.nocoder.org\r\nPerforming the following challenges:\r\nhttp-01 challenge <span class=\"token keyword\">for</span> nocoder.org\r\nhttp-01 challenge <span class=\"token keyword\">for</span> www.nocoder.org\r\nWaiting <span class=\"token keyword\">for</span> verification<span class=\"token punctuation\">..</span>.\r\nCleaning up challenges\r\nDeploying Certificate to VirtualHost /etc/nginx/conf.d/nocoder.org.conf\r\nDeploying Certificate to VirtualHost /etc/nginx/conf.d/nocoder.org.conf\r\nRedirecting all traffic on port <span class=\"token number\">80</span> to ssl <span class=\"token keyword\">in</span> /etc/nginx/conf.d/nocoder.org.conf\r\nRedirecting all traffic on port <span class=\"token number\">80</span> to ssl <span class=\"token keyword\">in</span> /etc/nginx/conf.d/nocoder.org.conf\r\n\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\nCongratulations<span class=\"token operator\">!</span> You have successfully enabled https://nocoder.org and\r\nhttps://www.nocoder.org\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\nSubscribe to the EFF mailing list <span class=\"token punctuation\">(</span>email: yangjinlong86@gmail.com<span class=\"token punctuation\">)</span>.\r\n\r\nIMPORTANT NOTES:\r\n - Congratulations<span class=\"token operator\">!</span> Your certificate and chain have been saved at:\r\n   /etc/letsencrypt/live/nocoder.org/fullchain.pem\r\n   Your key <span class=\"token function\">file</span> has been saved at:\r\n   /etc/letsencrypt/live/nocoder.org/privkey.pem\r\n   Your certificate will expire on <span class=\"token number\">2023</span>-09-05. To obtain a new or\r\n   tweaked version of this certificate <span class=\"token keyword\">in</span> the future, simply run\r\n   certbot again with the <span class=\"token string\">\"certonly\"</span> option. To non-interactively\r\n   renew *all* of your certificates, run <span class=\"token string\">\"certbot renew\"</span>\r\n - If you like Certbot, please consider supporting our work by:\r\n\r\n   Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate\r\n   Donating to EFF:                    https://eff.org/donate-le\r\n   </code></pre></div>\n<p>证书有效期为90天，证书到期后执行<code class=\"language-text\">certbot renew</code>续期即可，Certbot会自动更新证书，不需要手动替换文件。</p>\n<blockquote>\n<p>当然，没有到期就执行续期命令，会提示没到期不需要续期，不会生成新的证书。</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo certbot renew\r\nSaving debug log to /var/log/letsencrypt/letsencrypt.log\r\n\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\nProcessing /etc/letsencrypt/renewal/nocoder.org.conf\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\nCert not yet due for renewal\r\n\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\nThe following certificates are not due for renewal yet:\r\n  /etc/letsencrypt/live/nocoder.org/fullchain.pem expires on 2023-09-05 (skipped)\r\nNo renewals were attempted.\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</code></pre></div>\n<p>使用<code class=\"language-text\">curl -v</code>测试一下，网站访问正常。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">curl</span> <span class=\"token parameter variable\">-v</span>  https://nocoder.org\r\n*   Trying <span class=\"token number\">13.215</span>.120.28:443<span class=\"token punctuation\">..</span>.\r\n* Connected to nocoder.org <span class=\"token punctuation\">(</span><span class=\"token number\">13.215</span>.120.28<span class=\"token punctuation\">)</span> port <span class=\"token number\">443</span> <span class=\"token punctuation\">(</span><span class=\"token comment\">#0)</span>\r\n* ALPN, offering h2\r\n* ALPN, offering http/1.1\r\n* successfully <span class=\"token builtin class-name\">set</span> certificate verify locations:\r\n*  CAfile: /etc/ssl/certs/ca-certificates.crt\r\n*  CApath: /etc/ssl/certs\r\n* TLSv1.3 <span class=\"token punctuation\">(</span>OUT<span class=\"token punctuation\">)</span>, TLS handshake, Client hello <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>:\r\n* TLSv1.3 <span class=\"token punctuation\">(</span>IN<span class=\"token punctuation\">)</span>, TLS handshake, Server hello <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>:\r\n* TLSv1.3 <span class=\"token punctuation\">(</span>IN<span class=\"token punctuation\">)</span>, TLS handshake, Encrypted Extensions <span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>:\r\n* TLSv1.3 <span class=\"token punctuation\">(</span>IN<span class=\"token punctuation\">)</span>, TLS handshake, Certificate <span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span>:\r\n* TLSv1.3 <span class=\"token punctuation\">(</span>IN<span class=\"token punctuation\">)</span>, TLS handshake, CERT verify <span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span>:\r\n* TLSv1.3 <span class=\"token punctuation\">(</span>IN<span class=\"token punctuation\">)</span>, TLS handshake, Finished <span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span>:\r\n* TLSv1.3 <span class=\"token punctuation\">(</span>OUT<span class=\"token punctuation\">)</span>, TLS change cipher, Change cipher spec <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>:\r\n* TLSv1.3 <span class=\"token punctuation\">(</span>OUT<span class=\"token punctuation\">)</span>, TLS handshake, Finished <span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span>:\r\n* SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384\r\n* ALPN, server accepted to use http/1.1\r\n* Server certificate:\r\n*  subject: <span class=\"token assign-left variable\">CN</span><span class=\"token operator\">=</span>nocoder.org\r\n*  start date: Jun  <span class=\"token number\">7</span> 01:09:21 <span class=\"token number\">2023</span> GMT\r\n*  expire date: Sep  <span class=\"token number\">5</span> 01:09:20 <span class=\"token number\">2023</span> GMT\r\n*  subjectAltName: <span class=\"token function\">host</span> <span class=\"token string\">\"nocoder.org\"</span> matched cert<span class=\"token string\">'s \"nocoder.org\"\r\n*  issuer: C=US; O=Let'</span>s Encrypt<span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">CN</span><span class=\"token operator\">=</span>R3\r\n*  SSL certificate verify ok.\r\n<span class=\"token operator\">></span> GET / HTTP/1.1\r\n<span class=\"token operator\">></span> Host: nocoder.org\r\n<span class=\"token operator\">></span> User-Agent: curl/7.74.0\r\n<span class=\"token operator\">></span> Accept: */*\r\n<span class=\"token operator\">></span> \r\n* TLSv1.3 <span class=\"token punctuation\">(</span>IN<span class=\"token punctuation\">)</span>, TLS handshake, Newsession Ticket <span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>:\r\n* TLSv1.3 <span class=\"token punctuation\">(</span>IN<span class=\"token punctuation\">)</span>, TLS handshake, Newsession Ticket <span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>:\r\n* old SSL session ID is stale, removing\r\n* Mark bundle as not supporting multiuse\r\n<span class=\"token operator\">&lt;</span> HTTP/1.1 <span class=\"token number\">200</span> OK\r\n<span class=\"token operator\">&lt;</span> Server: nginx/1.18.0\r\n<span class=\"token operator\">&lt;</span> Date: Wed, 07 Jun <span class=\"token number\">2023</span> 02:48:26 GMT\r\n<span class=\"token operator\">&lt;</span> Content-Type: text/html\r\n<span class=\"token operator\">&lt;</span> Content-Length: <span class=\"token number\">76044</span>\r\n<span class=\"token operator\">&lt;</span> Last-Modified: Wed, 07 Jun <span class=\"token number\">2023</span> 01:45:08 GMT\r\n<span class=\"token operator\">&lt;</span> Connection: keep-alive\r\n<span class=\"token operator\">&lt;</span> ETag: <span class=\"token string\">\"647fe124-1290c\"</span>\r\n<span class=\"token operator\">&lt;</span> Accept-Ranges: bytes</code></pre></div>\n<p>最后，建议把letsencrypt生成的文件目录<code class=\"language-text\">/etc/letsencrypt</code>和Nginx的配置文件都整体备份一下，如果发生服务器迁移，就把整个文件打包迁移就可以继续工作。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">/etc/letsencrypt# ls\r\naccounts  cli.ini  keys  options-ssl-nginx.conf  renewal-hooks\r\narchive   csr      live  renewal                 ssl-dhparams.pem</code></pre></div>","frontmatter":{"title":"申请免费HTTPS证书","date":"2023年06月07日","description":null}},"previous":{"fields":{"slug":"/arts-46/"},"frontmatter":{"title":"ARTS 第46周：纪念皓哥"}},"next":null},"pageContext":{"id":"6f070c82-26a4-5229-a32c-a7c4070f9ace","previousPostId":"e4f4b2e5-0f9b-5587-9172-ade408ca8e72","nextPostId":null}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}