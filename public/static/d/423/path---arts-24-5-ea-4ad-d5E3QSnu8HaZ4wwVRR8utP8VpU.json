{"data":{"site":{"siteMetadata":{"title":"NoCoder Blog","author":"Jason Yang"}},"markdownRemark":{"id":"ea60ba91-0c7e-5c8e-b141-66ef1745c9bc","excerpt":"Algorithm Review Netty User guide discard server echo server time server Tip 使用 datax 将 mysql 数据导入 elasticsearch 访问  es-head  查看当前使用的 index 删除没用的   ，发送 HTTP…","html":"<h2>Algorithm</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>nocoder<span class=\"token punctuation\">.</span>leetcode<span class=\"token punctuation\">.</span>solution</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * 28. Implement strStr()\n * &lt;p>\n * Return the index of the first occurrence of needle in haystack, or -1 if needle is not part of haystack.\n * &lt;p>\n * Example 1:\n * &lt;p>\n * Input: haystack = \"hello\", needle = \"ll\"\n * Output: 2\n * Example 2:\n * &lt;p>\n * Input: haystack = \"aaaaa\", needle = \"bba\"\n * Output: -1\n * Clarification:\n * &lt;p>\n * What should we return when needle is an empty string?\n * This is a great question to ask during an interview.\n * &lt;p>\n * For the purpose of this problem, we will return 0 when needle is an empty string.\n * This is consistent to C's strstr() and Java's indexOf().\n *\n * @author yangjinlong\n * @date 2018-12-17\n */</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ImplementStrStr</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">strStr</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> haystack<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> needle<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">char</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> haystackArr <span class=\"token operator\">=</span> haystack<span class=\"token punctuation\">.</span><span class=\"token function\">toCharArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">char</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> needleArr <span class=\"token operator\">=</span> needle<span class=\"token punctuation\">.</span><span class=\"token function\">toCharArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>needleArr<span class=\"token punctuation\">.</span>length <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> haystackArr<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> needleArr<span class=\"token punctuation\">.</span>length <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">checkMatchingAtIndex</span><span class=\"token punctuation\">(</span>haystackArr<span class=\"token punctuation\">,</span> needleArr<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> i<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">checkMatchingAtIndex</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> haystackArr<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> needleArr<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> idx<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> needleArr<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>haystackArr<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> idx<span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> needleArr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ImplementStrStr</span> implementStrStr <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ImplementStrStr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>implementStrStr<span class=\"token punctuation\">.</span><span class=\"token function\">strStr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"llo\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>implementStrStr<span class=\"token punctuation\">.</span><span class=\"token function\">strStr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"aaaaaa\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bba\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>implementStrStr<span class=\"token punctuation\">.</span><span class=\"token function\">strStr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bbbbbb\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>implementStrStr<span class=\"token punctuation\">.</span><span class=\"token function\">strStr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mississipp\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"issip\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Review</h2>\n<h3><a href=\"https://netty.io/wiki/user-guide-for-4.x.html#wiki-h2-0\">Netty User guide</a></h3>\n<ul>\n<li>discard server</li>\n<li>echo server</li>\n<li>time server</li>\n</ul>\n<h2>Tip</h2>\n<h3>使用 datax 将 mysql 数据导入 elasticsearch</h3>\n<ul>\n<li>\n<p>访问 <a href=\"http://47.106.164.212:9100/\">es-head</a> 查看当前使用的 index</p>\n</li>\n<li>\n<p>删除没用的 <code class=\"language-text\">index</code> ，发送 HTTP <code class=\"language-text\">DELETE</code> 请求</p>\n<ul>\n<li><a href=\"http://47.106.164.212:9200/yuntu_librarys_v2\">http://47.106.164.212:9200/yuntu<em>librarys</em>v2</a></li>\n</ul>\n</li>\n<li>\n<p>创建<code class=\"language-text\">index</code>，发送 HTTP <code class=\"language-text\">PUT</code> 请求</p>\n<ul>\n<li>\n<p><a href=\"http://47.106.164.212:9200/yuntu_librarys_v2\">http://47.106.164.212:9200/yuntu<em>librarys</em>v2</a></p>\n</li>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n<span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"number_of_shards\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"number_of_replicas\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"refresh_interval\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10s\"</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p><a href=\"http://47.106.164.212:9200/yuntu_library_books_v2\">http://47.106.164.212:9200/yuntu<em>library</em>books_v2</a></p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token property\">\"number_of_shards\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"number_of_replicas\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"refresh_interval\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10s\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li></li>\n</ul>\n</li>\n<li>\n<p>发送 HTTP <code class=\"language-text\">POST</code> 请求，添加 mapping</p>\n<ul>\n<li>\n<p><a href=\"http://47.106.164.212:9200/yuntu_librarys_v2/doc/_mapping?pretty\">http://47.106.164.212:9200/yuntu<em>librarys</em>v2/doc/_mapping?pretty</a></p>\n</li>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n<span class=\"token property\">\"doc\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"properties\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token property\">\"id\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span>             \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"isbn\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                     <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>                                       \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"price\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                     <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"double\"</span>                                                                \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n               <span class=\"token property\">\"bookId\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                     <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span>                     \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"operUser\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                     <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span>                     \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"customerId\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                     <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span>                     \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"barNumber\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                     <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>               \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"isChecked\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                     <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>               \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n               <span class=\"token property\">\"checkedDate\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                     <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>               \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"frameCode\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                     <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>                                                 \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n     \n                <span class=\"token property\">\"isEffective\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                     <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>                                                 \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"bookName\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>          \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"author\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>                                              \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"publisher\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>      \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"publishDate\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>                                    \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n               <span class=\"token property\">\"storageTime\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>                                    \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"categoryCode\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                  <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>      \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"catalogueDate\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>                                           \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"bookState\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>                                       \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n               <span class=\"token property\">\"storeRoom\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>                                         \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n         \n                <span class=\"token property\">\"borrowNum\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span>  \n               <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n             <span class=\"token property\">\"canAppoint\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span>  \n               <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n              \n                 <span class=\"token property\">\"praiseNum\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"integer\"</span>  \n               <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"libCode\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span> \n               <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n               \n                <span class=\"token property\">\"belongLibraryHallCode\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span> \n               <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"callNumber\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n                     <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span> \n               <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"solrUpdate\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"date\"</span>                                      \n                   \n                <span class=\"token punctuation\">}</span>\n                   \n        <span class=\"token punctuation\">}</span> \n<span class=\"token punctuation\">}</span> \n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p>数据初始化</p>\n</li>\n<li>\n<p><code class=\"language-text\">datax</code> 用于初始化数据量较大的表，如 <code class=\"language-text\">library_books</code></p>\n<ul>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">python datax.py libraryBooks.json</code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">logstash</code> 用于持续同步数据</p>\n<ul>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Logstash:usr/local/elk/logstash/mysql.conf 下yuntu-library-books.cfg, yuntu-librarys.cfg 的index 值</code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>es 索引别名替换, HTTP <code class=\"language-text\">POST</code>请求</p>\n</li>\n<li>\n<p><a href=\"http://47.106.164.212:9200/_aliases\">http://47.106.164.212:9200/_aliases</a></p>\n</li>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n <span class=\"token property\">\"actions\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span> <span class=\"token property\">\"remove\"</span> <span class=\"token operator\">:</span> \n       \t<span class=\"token punctuation\">{</span> \n              <span class=\"token property\">\"index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"yuntu_library_books_v1\"</span><span class=\"token punctuation\">,</span> \n              <span class=\"token property\">\"alias\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"yuntu_library_books\"</span> \n          <span class=\"token punctuation\">}</span> \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span> <span class=\"token property\">\"add\"</span> <span class=\"token operator\">:</span> \n       \t<span class=\"token punctuation\">{</span> \n              <span class=\"token property\">\"index\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"yuntu_library_books_v2\"</span><span class=\"token punctuation\">,</span> \n              <span class=\"token property\">\"alias\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"yuntu_library_books\"</span> \n          <span class=\"token punctuation\">}</span> \n      <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n<h2>Share</h2>\n<h3><a href=\"https://github.com/waylau/netty-4-user-guide\">Chinese translation of Netty 4.x User Guide. 中文翻译《Netty 4.x 用户指南》</a></h3>\n<p>中文版 netty user guide 作为参考</p>","frontmatter":{"title":"ARTS-24","date":"2018-12-15 18:41:22"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/ARTS24/","previous":{"fields":{"slug":"/ARTS23/"},"frontmatter":{"title":"ARTS-23"}},"next":{"fields":{"slug":"/ARTS28/"},"frontmatter":{"title":"ARTS-28"}}}}